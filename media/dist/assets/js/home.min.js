function startCarousel(){"block"===CONFIG.mainExample.css("display")&&(CONFIG.carouselTimer=setInterval(advanceCarousel,CONFIG.carouselInterval))}function advanceCarousel(){"block"!==CONFIG.mainExample.css("display")&&clearInterval(CONFIG.carouselTimer),CONFIG.exampleCounter===CONFIG.carouselLen-1?CONFIG.exampleCounter=0:CONFIG.exampleCounter+=1,updateCarousel()}function updateCarousel(){setActiveTease(),setMain()}function setActiveTease(){CONFIG.subExamples.addClass("example-inactive").removeClass("example-active"),CONFIG.subExamples.eq(CONFIG.exampleCounter).addClass("example-active")}function setMain(){var e=CONFIG.subExamples.eq(CONFIG.exampleCounter),a=CONFIG.exampleTemplate({img_src:e.data("img-src"),caption:e.find(".example-copy").text(),slug:e.data("graph-type"),ga_label:e.data("ga-label"),url:e.find(".example-link").attr("href")});CONFIG.mainExample.html(a)}function restartTimer(){clearInterval(CONFIG.carouselTimer),startCarousel()}function pauseTimer(){clearInterval(CONFIG.carouselTimer)}function addExampleImg(){_.each(CONFIG.subExamples,function(e){var a=$(e);a.find(".example-img").attr("src",a.data("img-src"))})}function initSlideinNav(){openbtn.addEventListener("click",toggleNav),closebtn&&closebtn.addEventListener("click",toggleNav),$(".js-content-wrap").on("click",function(e){var a=e.target;isOpen&&a!==openbtn&&toggleNav()})}function populateSelect(e,a){var t="";e.sort(function(e,a){return e[0]>a[0]?1:-1}),_.each(e,function(a,l){t+=selectTemplate({option:e[l]})}),a.html(t)}function toggleNav(){isOpen?$(bodyEl).removeClass("show-site-nav-slidein"):$(bodyEl).addClass("show-site-nav-slidein"),isOpen=!isOpen}var CONFIG={mainExample:$(".example-main"),subExamples:$(".example-sub"),exampleCounter:0,carouselLen:$(".example-sub").length,carouselTimer:0,carouselInterval:5e3,exampleTemplate:_.template($(".atlas-example-template").html())};updateCarousel(),startCarousel(),$(window).load(addExampleImg()),CONFIG.subExamples.on({mouseenter:function(){var e=CONFIG.subExamples.index($(this));CONFIG.exampleCounter=e,updateCarousel(),pauseTimer()},mouseleave:function(){CONFIG.subExamples.addClass("example-inactive").removeClass("example-active"),CONFIG.subExamples.eq(CONFIG.exampleCounter).addClass("example-active"),restartTimer()}});var lazyLayout=_.debounce(function(){"block"===CONFIG.mainExample.css("display")&&restartTimer()},100);$(window).resize(lazyLayout);var selectTemplate=_.template($(".atlas-select-template").html()),bodyEl=document.body,openbtn=document.getElementById("open-button"),closebtn=document.getElementById("close-button"),isOpen=!1;initSlideinNav(),$.ajax({dataType:"json",url:"api/dropdowns/countries/"}).done(function(e){populateSelect(e,$(".js-select-countries"))}),$(".js-select-countries").on("change",function(){var e=$(this);ga("send",{hitType:"event",eventCategory:"Explore by Country",eventAction:"click",eventLabel:e.find("option:selected").text()}),window.location.href="../explore/tree_map/export/"+e.val()+"/all/show/2012/"}),$(".js-select-products").on("change",function(){var e=$(this);ga("send",{hitType:"event",eventCategory:"Explore by Product",eventAction:"click",eventLabel:e.find("option:selected").text()}),window.location.href="../explore/tree_map/export/show/all/"+e.val()+"/2012/"}),$(".track-click").on("click",function(){var e=$(this);ga("send",{hitType:"event",eventCategory:e.data("ga-category"),eventAction:"click",eventLabel:e.data("ga-label")})});